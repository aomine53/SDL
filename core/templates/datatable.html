{% extends "layouts/base.html" %}

{% block title %} Datatable {% endblock title %}

<!-- Specific CSS goes HERE  -->
{% block stylesheets %}
    <link href="https://unpkg.com/tabulator-tables@4.8.4/dist/css/tabulator_midnight.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />
{% endblock stylesheets %}

{% block content %}

    {#    <div class="container-fluid">#}
    {#        <h4 class="c-grey-900 mT-10 mB-30">Data Tables</h4>#}
    {#        <div class="row">#}
    {#            <div class="col-md-12">#}
    {#                <div class="bgc-white bd bdrs-3 p-20 mB-20">#}
    {#                    <h4 class="c-grey-900 mB-20">Bootstrap Data Table</h4>#}
    {#                    <table id="dataTable" class="table table-striped table-bordered" cellspacing="0" width="100%">#}
    {#                        <thead>#}
    {#                        <tr>#}
    {#                            <th>Driver Name</th>#}
    {#                            <th>Distance</th>#}
    {#                            <th>Duration</th>#}
    {#                            <th>From</th>#}
    {#                            <th>To</th>#}
    {#                            <th>Start</th>#}
    {#                            <th>End</th>#}
    {#                            <th>Max Speed</th>#}
    {#                            <th>Parking Time</th>#}
    {#                            <th>View</th>#}
    {##}
    {#                        </tr>#}
    {#                        </thead>#}
    {#                        <tfoot>#}
    {#                        <tr>#}
    {#                            <th>Driver Name</th>#}
    {#                            <th>Distance</th>#}
    {#                            <th>Duration</th>#}
    {#                            <th>From</th>#}
    {#                            <th>To</th>#}
    {#                            <th>Start</th>#}
    {#                            <th>End</th>#}
    {#                            <th>Max Speed</th>#}
    {#                            <th>Parking Time</th>#}
    {#                            <th>View</th>#}
    {##}
    {#                        </tr>#}
    {#                        </tfoot>#}
    {#                        <tbody>#}
    {#                        <tr>#}
    {#                            <td>Tiger Nixon</td>#}
    {#                            <td>System Architect</td>#}
    {#                            <td>Edinburgh</td>#}
    {#                            <td>61</td>#}
    {#                            <td>2011/04/25</td>#}
    {#                            <td>$320,800</td>#}
    {#                            <td>$320,800</td>#}
    {#                            <td>$320,800</td>#}
    {#                            <td>$320,800</td>#}
    {#                            <td>$320,800</td>#}
    {#                        </tr>#}
    {#                        </tbody>#}
    {#                    </table>#}
    {#                </div>#}
    {#            </div>#}
    {#        </div>#}
    {#    </div>#}
    <div class="text-right">
        <button id="download-pdf" class="btn btn-outline-danger btn-lg"><i class="fas fa-file-pdf"></i></button>
{#        <button id="download-json" class="btn btn-outline-light">JSON</button>#}
        <button id="download-xlsx" class="btn btn-outline-success btn-lg"><i class="fas fa-file-excel" ></i></button>
        <button id="download-csv" class="btn btn-outline-success btn-lg"><i class="fas fa-file-csv"></i></button>
        <button id="download-html" class="btn btn-outline-warning btn-lg"><i class="fab fa-html5" ></i></button>
    </div>
    <div id="example-table"></div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.8.4/dist/js/tabulator.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.0.5/jspdf.plugin.autotable.js"></script>
    <script type="text/javascript" src="https://oss.sheetjs.com/sheetjs/xlsx.full.min.js"></script>
    <script>
        {#var tabledata = [#}
        {#    {id: 1, name: "Oli Bob", age: "12", col: "red", dob: ""},#}
        {#    {id: 2, name: "Mary May", age: "1", col: "blue", dob: "14/05/1982"},#}
        {#    {id: 3, name: "Christine Lobowski", age: "42", col: "green", dob: "22/05/1982"},#}
        {#    {id: 4, name: "Brendon Philips", age: "125", col: "orange", dob: "01/08/1980"},#}
        {#    {id: 5, name: "Margret Marmajuke", age: "16", col: "yellow", dob: "31/01/1999"},#}
        {#];#}
        var table = new Tabulator("#example-table", {
            height: "100%",
            layout: "fitColumns",
            responsive: true,
            autoColumns: true,
        });
        document.getElementById("download-csv").addEventListener("click", function () {
            table.download("csv", "data.csv");
        });


        //trigger download of data.xlsx file
        document.getElementById("download-xlsx").addEventListener("click", function () {
            table.download("xlsx", "data.xlsx", {sheetName: "Trip Report"});
        });

        //trigger download of data.pdf file
        document.getElementById("download-pdf").addEventListener("click", function () {
            table.download("pdf", "data.pdf", {
                orientation: "portrait", //set page orientation to portrait
                title: "Trip Report", //add title to report
            });
        });

        //trigger download of data.html file
        document.getElementById("download-html").addEventListener("click", function () {
            table.download("html", "data.html", {style: true});
        });
    </script>
    <script>
        $.ajax({
            method: "GET",
            url: 'api/data/report',
            success: function (data) {
                console.log(data)
                table.setData(data.data)
            },
            error: function (error_data) {
                console.log("error")
                console.log(error_data)
            }
        })
    </script>
{% endblock javascripts %}
